{% extends "base.html" %}
{% load static i18n %}<!DOCTYPE html>
{% load crispy_forms_tags %}
{% load widget_tweaks %}

{% block title %}{{ user.username }}{% endblock %}

{% block content %}
<section class="box-content box-2">
  <div class="container">

    <form class="form-horizontal" autocomplete='off' method="post" action="{% url 'users:update' %}">
      {% csrf_token %}

      <div class="normal-box">
          <p>
          Hola <b>
          {% for invform in invitados.forms %}
              {% if not forloop.first %}y{% endif %}
          {{ invform.nombre.value }}{% endfor %},
          </b>
          </p>

          <br>

          <p>
          Aqui podeis escribir un mensaje que aparecera en la pagina
          principal en el apartado <b>"Lo que dicen de los novios"</b>
          </p>

          <br>

          <p>
          Tambien, podeis confirmar si quereis una plaza en el autobus,
          y ademas confirmar asistencia a algunas de las actividades que
          tenemos programadas.
          </p>
      </div>
      <br><br>
      {{ form }}

      <table class="table">
          {{ invitados.management_form }}

          {% for invform in invitados.forms %}
              {% if forloop.first %}
                  <thead>
                  <tr class="row formset_row">
                      {% for field in invform.visible_fields %}
                          <th>{{ field.label|capfirst }}</th>
                      {% endfor %}
                  </tr>
                  </thead>
              {% endif %}
              <tr class="row formset_row">
                  <td>
                      {# Include the hidden fields in the form #}
                      {% for hidden in invform.hidden_fields %}
                          {{ hidden }}
                      {% endfor %}
                      {{ invform.nombre.value }}
                  </td>
                  <td>
                      {{ invform.asiste }}
                  </td>
                  <td>
                      {{ invform.autobus }}
                  </td>
                  <td>
                      {{ invform.llegada|add_error_class:"is-invalid" }}
                  </td>
                  <td>
                      {{ invform.salida }}
                  </td>
              </tr>
          {% endfor %}
      </table>

      {% for invform in invitados.forms %}
          {% if invform.errors%}
          <div class="alert alert-danger" role="alert">
              {{ invform.nombre.value }}
              {{ invform.errors.as_ul }}
          </div>
          {% endif %}
      {% endfor %}

      <div class="control-group">
        <div class="controls">
          <button type="submit" class="btn btn-primary">Update</button>
        </div>
      </div>
    </form>

  </div>
</section>
{% endblock %}

{% block javascriptsources %}
    <script type="text/javascript" src="{% static 'js/bootstrap-datepicker.min.js' %}"></script>

{% endblock %}

{% block extrajs %}
$('[id$=salida], [id$=llegada]').datepicker({
    format: "dd/mm/yyyy",
    startDate: "12/9/2019",
    endDate: "26/9/2019",
    maxViewMode: 1
});

{% endblock %}

{% block morecss %}
    <link rel="stylesheet" href="{% static 'css/bootstrap-datepicker.min.css' %}"  type="text/css">
{% endblock %}
